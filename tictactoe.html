<!DOCTYPE html>
<html>
<head>
	<title></title>

	<style type="text/css">
	html, body{
		width:30%; 
		width:30%; 
		margin:0; 
		padding:0;
	}

	#field {
		width:30%; 
		height:30%;
	}
	.one, .two, .three, .four, .five,
	 .six, .seven, .eight, .nine{ 
		border:1px solid #000;
		padding-bottom: 30%; 
		height: 0;
		width:30%; 
		margin:1%; 
		float:left; 
		display:block;
		text-align: center;		
	}
	</style>
	
	<script src="https://cdn.pubnub.com/pubnub.min.js"></script>
	 
	<!-- Instantiate PubNub -->
	<script type="text/javascript">

	  var PUBNUB_demo = PUBNUB.init({
	    publish_key: 'pub-c-0e75fdb6-796c-4365-86e3-93e9fa4d4797',
	    subscribe_key: 'sub-c-1e21f940-73d7-11e4-ac4b-02ee2ddab7fe'
	  });

	  //Subscribe to the demo_tutorial channel
		PUBNUB_demo.subscribe({
		  channel: 'my_channel',
		  message: function(m){console.log(m)}
		});
		
		// Publish a simple message to the demo_tutorial channel
        PUBNUB_demo.publish({
            channel: 'connection',
            message: {"text":"Someone connected!"}
         });
        	  
	</script>
</head>
<body>
<div class="field">
	<div class="one">1</div>
	<div class="two">2</div>
	<div class="three">3</div>
	<div class="four">4</div>
	<div class="five">5</div>
	<div class="six">6</div>
	<div class="seven">7</div>
	<div class="eight">8</div>
	<div class="nine">9</div>
</div>

<script type="text/javascript">
	(function() {
		console.log('Started...');

		var pMark = '*';

		getNode = function (s) {
			return document.querySelector(s);
		};
		getFields = function () {
			var arr = [];
			arr.push(getNode('.one'));
			arr.push(getNode('.two'));
			arr.push(getNode('.three'));
			arr.push(getNode('.four'));
			arr.push(getNode('.five'));
			arr.push(getNode('.six'));
			arr.push(getNode('.seven'));
			arr.push(getNode('.eight'));
			arr.push(getNode('.nine'));
			return arr;
		};

		var fieldz = getFields();

		setStatus = function (s) {
			console.log(s);
			console.log(fieldz);
			for (var i = 0; i < fieldz.length; i++) {
				fieldz[i].textContent = s.charAt(i);
				console.log(s.charAt(i));
			}
		};


		if (PUBNUB_demo !== undefined) {
			console.log('PUBNUB_demo is defined');

			/*socket.on('status', function(data) {
				//console.log('status: ' + data);
				setStatus(data);
			});

			socket.on('playerMark', function(data) {
				console.log('playerMark: ' + data);
				pMark = data;
				console.log("Player mark is: " + data);
			});*/
		};


		var field = getNode('.field');
		field.addEventListener('click', function(e) {
			evt = e || window.event;
			console.log(evt.toElement.className);

            PUBNUB_demo.publish({
                channel: 'turn',
                message: {
				pMark : pMark,
				fieldName : evt.toElement.className
            }});
		});
	})();


</script>

</body>
</html>